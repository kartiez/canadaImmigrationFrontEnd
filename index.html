<!doctype html>
<html class="no-js" lang="zxx">
<style>
 body {font-family: Arial, Helvetica, sans-serif;}
 * {box-sizing: border-box;}

/* Button used to open the contact form - fixed at the bottom of the page */
 .open-button {
  background-color: #555;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  opacity: 0.8;
  position: fixed;
  bottom: 0 px;
  right: 28px;
  width: 280px;
 }
 /* The popup form - hidden by default */
 .form-popup {
  display: none;
  position: fixed;
  bottom: 100px;
  right: 850px;
  border: 3px solid #f1f1f1;
  z-index: 20;
 }

/* Add styles to the form container */
 .form-container {
  max-width: 300px;
  padding: 10px;
  background-color: white;
 }
/* Full-width input fields */
 .form-container input[type=text], .form-container input[type=password], .form-container select  {
  width: 100%;
  padding: 15px;
  margin: 5px 0 22px 0;
  border: none;
  background: #f1f1f1;
 }

/* When the inputs get focus, do something */
 .form-container input[type=text]:focus, .form-container input[type=password]:focus, .form-container select:focus{
  background-color: #ddd;
  outline: none;
 }

/* Set a style for the submit/login button */
 .form-container .btn {
  background-color: #4CAF50;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  width: 100%;
  margin-bottom:10px;
  opacity: 0.8;
 }

/* Add a red background color to the cancel button */
 .form-container .cancel {
  background-color: red;
 }

/* Add some hover effects to buttons */
 .form-container .btn:hover, .open-button:hover {
  opacity: 1;
 }
 .btn-edit
 {
    background-color: red;
}
.btn-edit:focus
{
   background-color: green;
}

</style>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Immigration</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
    <!-- Place favicon.ico in the root directory -->

    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/slick.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <!-- <link rel="stylesheet" href="css/responsive.css"> -->
</head>

<body>


    <!-- header-start -->
    <header>
        <div class="header-area ">
            <div class="header-top_area d-none d-lg-block">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-xl-4 col-lg-4">
                            <div class="logo">
                                <a href="index.html">
                                    <img src="img/logo.png" alt="">
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-8 col-md-8">
                            <div class="header_right d-flex align-items-center">
                                <div class="short_contact_list">
                                    <ul>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="sticky-header" class="main-header-area">
                <div class="container">
                    <div class="header_bottom_border">
                        <div class="row align-items-center">
                            <div class="col-12 d-block d-lg-none">
                                <div class="logo">
                                    <a href="index.html">
                                        <img src="img/logo.png" alt="">
                                    </a>
                                </div>
                            </div>


                            <div class="col-12">
                                <div class="mobile_menu d-block d-lg-none"></div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </header>
    <!-- header-end -->

    <!-- slider_area_start -->
    <div class="slider_area">
        <div class="single_slider  d-flex align-items-center slider_bg_1">
            <div class="container">
                <div class="row align-items-center justify-content-center">
                    <div class="col-xl-8">
                        <div class="slider_text text-center justify-content-center">
                          <h3>Canada Immigration Data</h3>
                          <a href="https://www.canada.ca/en/immigration-refugees-citizenship/services/immigrate-canada/express-entry/submit-profile/rounds-invitations/results-previous.html">
                            <p>Source : canada.ca</p>
                         </a

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- slider_area_end -->

      <!-- Table -->


    <div class="card">
  <h3 class="card-header text-center font-weight-bold text-uppercase py-4">Immigration Data from Canada.Ca</h3>
  <button type="button"
      class="btn btn-danger" ></button>

  <div class="card-body">
    <div id="table" class="table-editable">
      <span class="table-remove"><button type="button"
          class="btn btn-info btn-rounded btn-sm" onclick="openForm()">Add</button>
          <br/>
          <br/>
          <div class="form-popup" id="myForm">
            <form action="/action_page.php" class="form-container">
              <h1>Add New Line</h1>
              <label for="email"><b>Day</b></label>
              <input id="ca_date" type="text" placeholder="0-31" required>
              <label for="email"><b>Month</b></label><br>
              <select id= ca_month style="width: 100px !important; min-width: 100px; max-width: 100px;" required>
              <option value="January">January</option>
              <option value="February">February</option>
              <option value="March">March</option>
              <option value="April">April</option>
              <option value="May">May</option>
              <option value="June">June</option>
              <option value="July">July</option>
              <option value="August">August</option>
              <option value="September">September</option>
              <option value="October">October</option>
              <option value="November">November</option>
              <option value="December">December</option>
            </select><br><br>
              <label for="email"><b>Year</b></label>
              <input id="ca_year" type="text" placeholder="YYYY" required>
              <label for="psw"><b>Invities</b></label>
              <input id="ca_num" type="text" placeholder="#" required>
              <label for="email"><b>CRS Score</b></label>
              <input id="ca_score" type="text" placeholder="#"  required>
              <button type="submit" class="btn" onclick="create_new()">Add</button>
              <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
            </form>
          </div>

        </span>
      <table id="mytable" class="table table-bordered table-responsive-md table-striped text-center">
        <thead>
          <tr>
            <th class="text-center">Ref No:</th>
            <th class="text-center">Date</th>
            <th c lass="text-center">Month</th>
            <th class="text-center">Year</th>
            <th class="text-center">Number of Invities</th>
            <th class="text-center">CRS Score</th>
            <th class="text-center">Edit/Remove</th>
          </tr>
        </thead>
        <tbody id=name contenteditable="false" >

          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

  <!-- Table -->


    <!-- footer start -->
    <footer class="footer">

        <div class="copy-right_text">
            <div class="container">
                <div class="footer_border"></div>
                <div class="row">
                    <div class="col-xl-12">
                        <p class="copy_right text-center">
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--/ footer end  -->
<!-- Button trigger modal -->

    <!-- JS here -->
<script type="text/javascript">

// Create an HTTP Connection Request

var HttpClient = function () {
    this.get = function (url, para, aCallback) {
        var anHttpRequest = new XMLHttpRequest();
        anHttpRequest.onreadystatechange = function () {
            if (anHttpRequest.readyState == 4 && anHttpRequest.status == 200)
                aCallback(anHttpRequest.responseText);
        }

        if (para == null) {
            anHttpRequest.open("GET", url, true);
        }
        else {
            anHttpRequest.open("GET", url + "?" + para, true);
        }
        anHttpRequest.send(null);
    }
}

//Define global variables

var i=1;
const ip = '10.250.21.147'; //public ip
const port = '8080';
const address = 'http://' + ip + ':' + port + '/'; //Generate complete IP Address with port
const list_url = address + 'list'; //URL to get list
addList(); //Call function to all elements to the table

//Function to add the data from the database to the table

function addList()
{
  var client = new HttpClient();
  client.get(list_url, null, function (res) {
              var a = JSON.parse(res);
              for (var key in a)
              {
                var tableRef = document.getElementById('mytable').getElementsByTagName('tbody')[0]
                var newRow   = tableRef.insertRow(tableRef.rows.length);
                newRow.contentEditable = false;
                newRow.id = "row"+i;
                var cell1  = newRow.insertCell(0);
                var cell2  = newRow.insertCell(1);
                var cell3  = newRow.insertCell(2);
                var cell4  = newRow.insertCell(3);
                var cell5  = newRow.insertCell(4);
                var cell6  = newRow.insertCell(5);
                var cell7  = newRow.insertCell(6);
                cell1.innerHTML = key;
                cell1.contentEditable = false;
                cell1.Disabled = 'disabled';
                cell2.innerHTML = a[key].date;
                cell3.innerHTML = a[key].month;
                cell4.innerHTML = a[key].year;
                cell5.innerHTML = a[key].no_of_invitations_issued;
                cell6.innerHTML = a[key].score;
                cell7.innerHTML =  '<button type="button"class="btn btn-primary btn-rounded btn-sm my-0" id="xca" contenteditable="false" onclick="enable(this,'+i+','+key+')">Edit </button><button type="button"class="btn btn-danger btn-rounded btn-sm my-0" id="xca" contenteditable="false" onclick="deleteRow(this,'+key+')"> Remove</button>';
                i++;
              }
    });

}

 // Function to enable edit button

function enable(button,r,old_id,) {

  id = 'row'+r;
  //alert(id);
  var x = document.getElementById(id);
  if (x.contentEditable == "true") {
     x.contentEditable = "false";
     button.innerHTML = "Edit ";
     button.style.backgroundColor = "#297AD6";
     if (confirm('Are you sure you want to update the row? ')) {
       var tableRef = document.getElementById('mytable').getElementsByTagName('tbody')[0];
       var date = tableRef.rows[r-1].cells[0].innerHTML;
       var month = tableRef.rows[r-1].cells[1].innerHTML;
       var year = tableRef.rows[r-1].cells[2].innerHTML;
       var numb = tableRef.rows[r-1].cells[3].innerHTML;
       var score = tableRef.rows[r-1].cells[4].innerHTML;
       var updatestring = "";
       console.log(id);
       updatestring = "id="+old_id+"&date="+date+"&month="+month+"&year="+year+"&no_of_invitations_issued="+numb+"&score="+score;
       //alert(updatestring);
       const update_url = address + 'update';
       var call = new HttpClient();
       call.get(update_url, updatestring, function (res) {

            // send update request
          });

        } else {
        //Do nothing
      }

    }
  else
    {
      x.contentEditable = "true";
      button.innerHTML = "Save";
      button.style.backgroundColor = "red";

    }
}

// Function to open the 'add new element' form  :

function openForm()
{
  document.getElementById("myForm").style.display = "block";
}

// Function to add a new row to the list  :

function create_new()
{
  if(document.getElementById("ca_date")==""||document.getElementById("ca_date")== null||document.getElementById("ca_date")== undefined)
  {
    alert("Please complete the form to proceed!");
  }
  else{

  //alert("Please complete the form to proceed!");
  var newline = "";
  const add_url = address + 'add';
  var tableRef = document.getElementById('mytable').getElementsByTagName('tbody')[0]
  var newRow   = tableRef.insertRow(tableRef.rows.length);
  newRow.id = "row"+i;
  newRow.contentEditable = false;
  var cell1  = newRow.insertCell(0);
  var cell2  = newRow.insertCell(1);
  var cell3  = newRow.insertCell(2);
  var cell4  = newRow.insertCell(3);
  var cell5  = newRow.insertCell(4);
  var cell6  = newRow.insertCell(5);
  var cell7  = newRow.insertCell(6);
  cell1.innerHTML = i-1;
  var e = document.getElementById("ca_month");
  cell2.innerHTML = document.getElementById('ca_date').value;
  //cell3.innerHTML = document.getElementById('ca_month').value;
  cell3.innerHTML = e.options[e.selectedIndex].value;
  cell4.innerHTML = document.getElementById('ca_year').value;
  cell5.innerHTML = document.getElementById('ca_num').value;
  cell6.innerHTML = document.getElementById('ca_score').value;

  newline = "date="+cell2.innerHTML+"&month="+cell3.innerHTML+"&year="+cell4.innerHTML+"&no_of_invitations_issued="+cell5.innerHTML+"&score="+cell6.innerHTML;
  var call = new HttpClient();
  //alert(newline);
  call.get(add_url, newline, function (res) {
  newItem_ID = JSON.parse(res);
  //alert(newItem_ID.id);
  cell7.innerHTML =  '<button type="button"class="btn btn-primary btn-rounded btn-sm my-0" id="xca" contenteditable="false" onclick="enable(this,'+i+','+newItem_ID.id+')">Edit </button><button type="button"class="btn btn-danger btn-rounded btn-sm my-0" id="xca" contenteditable="false" onclick="deleteRow(this,'+newItem_ID.id+')"> Remove</button>';
  i++;
    });
closeForm();
  }
}

// Function to close the 'add new element' form  :

function closeForm()
{
  document.getElementById("myForm").style.display = "none";
  document.getElementById('ca_date').value="";
  document.getElementById('ca_month').value="";
  document.getElementById('ca_num').value="";
  document.getElementById('ca_year').value="";
  document.getElementById('ca_score').value="";
}

// Function to delete a row from the table :

function deleteRow(r,del_id)
{
    var delete_row = r.parentNode.parentNode.rowIndex;
    var para = "id="+del_id;
    //alert(para);
    if (confirm('Are you sure you want to delete the row? ')) {
        document.getElementById("mytable").deleteRow(delete_row);
        const delete_url = address + 'delete';
        var call = new HttpClient();

        call.get(delete_url, para, function (res) {

          //send delete request
          });

      } else {
          //do nothing
      }
}
</script>
    <script src="js/GetData.js" type="text/javascript"></script>
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/plugins.js"></script>
    <!-- <script src="js/gijgo.min.js"></script> -->
    <script src="js/slick.min.js"></script>



    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>


    <script src="js/main.js"></script>




</body>

</html>
